% !TEX TS-program xelatex
% !TEX encoding = UTF-8 Unicode
% -*- coding: UTF-8; -*-
% vim: set fenc=utf-8

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  FileName: timozerdirtree.sty
%%  Author:   Timozer
%%  E-mail:   zhenyuwang94@gmail.com
%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{timozerdirtree}[2018/02/03 v0.6 Directory Tree]

\RequirePackage[edges]{forest}
\RequirePackage{xparse}
\RequirePackage{xcolor}
\RequirePackage{tikz}
\RequirePackage{etoolbox}

\definecolor{folderbg}{RGB}{124, 166, 198}
\definecolor{folderborder}{RGB}{110, 144, 169}

\newlength\Size
\setlength\Size{4pt}

\tikzset{%
    folder/.pic={%
        \filldraw [draw=folderborder, top color=folderbg!50, bottom color=folderbg] (-1.05*\Size, 0.2\Size+5pt) rectangle ++(0.75*\Size, -0.2\Size-5pt);
        \filldraw [draw=folderborder, top color=folderbg!50, bottom color=folderbg] (-1.15*\Size, -\Size) rectangle (1.15*\Size, \Size);
        },
    file/.pic={%
        \filldraw [draw=folderborder, top color=folderbg!5, bottom color=folderbg!10] (-\Size, .4*\Size+5pt) coordinate (a) |- (\Size, -1.2*\Size) coordinate (b) -- ++(0, 1.6*\Size) coordinate (c) -- ++(-5pt, 5pt) coordinate (d) -- cycle (d) |- (c);
        },
    }

\forestset{%
    declare autowrapped toks={pic me}{},
    declare boolean register={pic root},
    pic root=0,
    pic dir tree/.style={%
        for tree={%
            folder,
            font=\ttfamily\small,
            grow'=0,
            },
        before typesetting nodes={%
            for tree={%
                edge label+/.option={pic me},
                },
            if pic root={
                tikz+={
                    \pic at ([xshift=\Size].west) {folder};
                },
                align={l}
            }{},
            },
        },
    pic me set/.code n args=2{%
        \forestset{%
            #1/.style={%
                inner xsep=2\Size,
                pic me={pic {#2}},
                }
            }
        },
    pic me set={dir}{folder},
    pic me set={file}{file},
    }

    % tier for align horizontally although they occur at diff levels tier=name
    % delay={}
    % if <option>=<val><true><false>
    % where n children=0{tier=word}{}
    % u stands for the parent node(up)
    % p for the previous sibling
    % n for the next sibling
    % s for the sibling(useful only in binary trees)
    % 1, 2, ... 9 for the first, second, ... ninth child
    % l for the last child 
    % !us = up + sibling

\endinput 
